import streamlit as st
st.set_page_config(
    page_title="ãƒ©ã‚¤ãƒ•ãƒ»ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼è¨ºæ–­",
    page_icon="ğŸ—ºï¸",
    menu_items={
        'Get Help': 'https://www.extremelycoolapp.com/help',
        'Report a bug': "https://www.extremelycoolapp.com/bug",
        'About': "# ãƒ©ã‚¤ãƒ•ãƒ»ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ãƒ¼è¨ºæ–­\nã‚ãªãŸã®äººç”Ÿã®ã€Œç¾åœ¨åœ°ã€ã‚’æ¸¬ã‚‹ã€‚"
    }
)
import pandas as pd
import plotly.graph_objects as go
import statistics

st.markdown(
    '<meta property="og:image" content="Life mapping\Life-Mapping\Life Mapping.png">',
    unsafe_allow_html=True
)

# --- ãƒšãƒ¼ã‚¸è¨­å®š ---
st.set_page_config(
    page_title="Life Mapping Diagnosis",
    page_icon="ğŸ§­",
    layout="wide",
    initial_sidebar_state="collapsed"
)

# --- CSS (ãƒ‡ã‚¶ã‚¤ãƒ³èª¿æ•´) ---
st.markdown("""
<style>
    .main-header {font-size: 2.5rem; color: #1E3A8A; text-align: center; font-weight: 700; margin-bottom: 1rem;}
    .sub-header {font-size: 1.2rem; color: #4B5563; text-align: center; margin-bottom: 2rem;}
    .category-header {color: #1E3A8A; border-bottom: 2px solid #1E3A8A; padding-bottom: 5px; margin-top: 20px; font-weight: bold;}
    
    /* â–¼ ã“ã“ã‚’ä¿®æ­£ã—ã¾ã—ãŸï¼ˆcolorã‚’è¿½åŠ ï¼‰ */
    .feedback-box {
        background-color: #f8fafc; 
        border-left: 5px solid #1E3A8A; 
        padding: 15px; 
        border-radius: 5px; 
        margin-top: 10px; 
        margin-bottom: 20px;
        color: #334155; /* æ–‡å­—è‰²ã‚’å¼·åˆ¶çš„ã«æ¿ƒã„è‰²ã«ã™ã‚‹ */
    }
    
    .tag-blue {color: #1d4ed8; font-weight: bold;} 
    .tag-green {color: #15803d; font-weight: bold;}
    .tag-red {color: #b91c1c; font-weight: bold;}
    div.stButton > button:first-child {background-color: #1E3A8A; color: white; border-radius: 8px; font-size: 1.2rem; width: 100%; padding: 0.5rem;}
    div.stButton > button:hover {background-color: #2563EB; border: none;}
</style>
""", unsafe_allow_html=True)

# --- 1. è¨­å•ãƒ‡ãƒ¼ã‚¿ (Database) ---
questions_data = {
    "å“²å­¦ (Philosophy)": [
        "ç§ã¯ã€ã€Œè‡ªåˆ†ã«ã¨ã£ã¦ã®å¹¸ã›ã¨ã¯ä½•ã‹ã€ã‚’è‡ªåˆ†ã®è¨€è‘‰ã§èªã‚Œã‚‹ã€‚",
        "ç¤¾ä¼šã®å¸¸è­˜ã‚„ä»–äººã®æœŸå¾…ã‚ˆã‚Šã‚‚ã€è‡ªåˆ†ã®å¿ƒã®å£°ã‚’å„ªå…ˆã§ãã¦ã„ã‚‹ã€‚",
        "æ—¥ã€…ã®ç”Ÿæ´»ã®ä¸­ã§ã€å¿ƒã‹ã‚‰ã€Œæº€ãŸã•ã‚Œã¦ã„ã‚‹ã€ã¨æ„Ÿã˜ã‚‹ç¬é–“ãŒå¤šã„ã€‚",
        "éå»ã®é¸æŠã«å¯¾ã—ã¦å¾Œæ‚”ã¯ãªãã€ã™ã¹ã¦ã®çµŒé¨“ã«æ„å‘³ãŒã‚ã£ãŸã¨æ€ãˆã‚‹ã€‚",
        "ã‚‚ã—æ˜æ—¥äººç”ŸãŒçµ‚ã‚ã‚‹ã¨ã—ã¦ã‚‚ã€ä»Šã®ç”Ÿãæ–¹ã«ç´å¾—ã§ãã‚‹ã€‚",
        "è‡ªåˆ†ã®ã€Œæ ¸ã€ã¨ãªã‚‹ä¾¡å€¤è¦³ã‚’è¨€èªåŒ–ã§ãã¦ã„ã‚‹",
        "è¿·ã£ãŸæ™‚ã€ç«‹ã¡è¿”ã‚‹ã¹ãåˆ¤æ–­åŸºæº–ãŒã‚ã‚‹",
    ],
    "ç’°å¢ƒ (Environment)": [
        "ç¾åœ¨ã®ä½ã¾ã„ã‚„æ´»å‹•å ´æ‰€ã¯ã€è‡ªåˆ†ã«ã¨ã£ã¦å±…å¿ƒåœ°ãŒè‰¯ãã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå……é›»ã§ãã‚‹å ´æ‰€ã ã€‚",
        "å°†æ¥ã¸ã®ä¸å®‰ã«è„…ã‹ã•ã‚Œã‚‹ã“ã¨ãªãã€å®‰å¿ƒã—ã¦æš®ã‚‰ã›ã‚‹çµŒæ¸ˆçš„ãªåŸºç›¤ãŒã‚ã‚‹ã€‚",
        "å¿™ã—ã•ã«è¿½ã‚ã‚Œã‚‹ã“ã¨ãªãã€ä½•ã‚‚ã—ãªã„æ™‚é–“ã‚„è¶£å‘³ã‚’æ¥½ã—ã‚€ã€Œä½™ç™½ã€ãŒã‚ã‚‹ã€‚",
        "èº«ã®å›ã‚Šã«ã¯ã€è‡ªåˆ†ãŒã¨ãã‚ãç‰©ã‚„å¥½ããªç‰©ã ã‘ã‚’ç½®ã„ã¦ã„ã‚‹ã€‚",
        "å«Œãªã“ã¨ã‚„åˆã‚ãªã„ç’°å¢ƒã‹ã‚‰ã¯ã€è·é›¢ã‚’ç½®ãã“ã¨ãŒã§ãã¦ã„ã‚‹ã€‚",
        "å¿ƒã‹ã‚‰å®‰ã‚‰ã’ã‚‹å±…å ´æ‰€ï¼ˆå®¶åº­ã‚„ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼‰ãŒã‚ã‚‹",
        "çµŒæ¸ˆçš„ãªä¸å®‰ã«è„…ã‹ã•ã‚Œã‚‹ã“ã¨ãªãç”Ÿæ´»ã§ãã¦ã„ã‚‹",
        "è‡ªåˆ†ã®èƒ½åŠ›ã‚’ç™ºæ®ã§ãã‚‹ç’°å¢ƒã«èº«ã‚’ç½®ã„ã¦ã„ã‚‹",
    ],
    "æ‰èƒ½ (Talent)": [
        "è‡ªåˆ†ãŒæƒ…ç†±ã‚’æ³¨ã’ã‚‹ã€Œå¼·ã¿ã€ã‚„ã€Œã‚®ãƒ•ãƒˆã€ã‚’è‡ªè¦šã—ã¦ã„ã‚‹",
        "ãã®æ‰èƒ½ã‚’ä½¿ã£ã¦ã€ä»–è€…ã«è²¢çŒ®ã—ã¦ã„ã‚‹å®Ÿæ„ŸãŒã‚ã‚‹",
        "ä»•äº‹ã‚„æ´»å‹•ã®ä¸­ã§ã€ãƒ•ãƒ­ãƒ¼çŠ¶æ…‹ï¼ˆæ²¡é ­ï¼‰ã«ãªã‚‹ã“ã¨ãŒå¤šã„",
        "æ™‚é–“ã‚’å¿˜ã‚Œã¦æ²¡é ­ã§ãã‚‹ã“ã¨ã‚„ã€ã‚„ã£ã¦ã„ã¦è‹¦ã«ãªã‚‰ãªã„ã€Œå¾—æ„ãªã“ã¨ã€ãŒã‚ã‚‹ã€‚",
        "è‡ªåˆ†ã®æ‰èƒ½ã‚„å¼·ã¿ã‚’ä½¿ã£ã¦ã€èª°ã‹ã«å–œã‚“ã§ã‚‚ã‚‰ãˆãŸçµŒé¨“ãŒã‚ã‚‹ã€‚",
        "ä»•äº‹ã‚„æ´»å‹•ã«ãŠã„ã¦ã€ç„¡ç†ã‚’ã—ã¦è‡ªåˆ†ã‚’å½ã‚‹ã“ã¨ãªãã€è‡ªç„¶ä½“ã§ã„ã‚‰ã‚Œã‚‹ã€‚",
        "ã€Œã‚ãªãŸã«ãŠé¡˜ã„ã—ãŸã„ã€ã€Œã‚ãªãŸã¨å±…ãŸã„ã€ã¨è¨€ã‚ã‚Œã‚‹ç‹¬è‡ªã®é­…åŠ›ãŒã‚ã‚‹ã€‚",
        "æ–°ã—ã„çŸ¥è­˜ã‚„ä½“é¨“ã«è§¦ã‚Œã€è‡ªåˆ†ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‚’æ¥½ã—ã‚“ã§ã„ã‚‹ã€‚",
    ],
    "æ§‹æƒ³ (Vision)": [
        "1å¹´å¾Œã€3å¹´å¾Œã®ç†æƒ³ã®æœªæ¥ãŒé®®æ˜ã«æã‘ã¦ã„ã‚‹",
        "å¤¢ã‚„ç›®æ¨™ã«å‘ã‹ã£ã¦ã€å…·ä½“çš„ãªè¨ˆç”»ãŒé€²ã‚“ã§ã„ã‚‹",
        "æœªæ¥ã®ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹",
        "3å¹´å¾Œã€5å¹´å¾Œã«ã€Œã“ã†ãªã£ã¦ã„ãŸã„ã€ã¨ã„ã†ç†æƒ³ã®ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ãŒæã‘ã¦ã„ã‚‹ã€‚",
        "å¤¢ã‚„ç›®æ¨™ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ä»Šæ—¥ã§ãã‚‹å°ã•ãªä¸€æ­©ã‚’è¸ã¿å‡ºã—ã¦ã„ã‚‹ã€‚",
        "ã€Œæ­»ã¬ã¾ã§ã«ã‚„ã‚ŠãŸã„ã“ã¨ãƒªã‚¹ãƒˆã€ã®ã‚ˆã†ãªã€äººç”Ÿã®æ¥½ã—ã¿ã®è¨ˆç”»ãŒã‚ã‚‹ã€‚",
        "äºˆæœŸã›ã¬å¤‰åŒ–ãŒèµ·ãã¦ã‚‚ã€ã€Œãã‚Œã¯ãã‚Œã§é¢ç™½ã„ã€ã¨æŸ”è»Ÿã«æ‰ãˆã‚‰ã‚Œã‚‹ã€‚",
        "æœªæ¥ã®ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ã€ä¸å®‰ã‚ˆã‚Šã‚‚ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹æ°—æŒã¡ã®æ–¹ãŒå¤§ãã„ã€‚",
    ],
    "å¥åº· (Vitality)": [
        "æ¯æ—¥ã€ååˆ†ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã£ã¦æ´»å‹•ã§ãã¦ã„ã‚‹",
        "ç¡çœ ã‚„é£Ÿäº‹ãªã©ã€èº«ä½“ã®ã‚±ã‚¢ã‚’å¤§åˆ‡ã«ã—ã¦ã„ã‚‹",
        "ã‚¹ãƒˆãƒ¬ã‚¹ã‚’é©åˆ‡ã«è§£æ¶ˆã—ã€ãƒ¡ãƒ³ã‚¿ãƒ«ãŒå®‰å®šã—ã¦ã„ã‚‹",
        "æ¯æœã€ã™ã£ãã‚Šã¨ã—ãŸæ°—åˆ†ã¨ååˆ†ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ç›®è¦šã‚ã¦ã„ã‚‹ã€‚",
        "é£Ÿäº‹ã¯å‘³ã‚ã£ã¦ã¨ã‚Šã€è‡ªåˆ†ã®èº«ä½“ãŒå–œã¶ã‚‚ã®ã‚’é£Ÿã¹ã¦ã„ã‚‹æ„Ÿè¦šãŒã‚ã‚‹ã€‚",
        "æ—¥ä¸­ã€èº«ä½“ã®é‡ã•ã‚„ã ã‚‹ã•ã‚’æ„Ÿã˜ã‚‹ã“ã¨ãªãã€å¿«é©ã«å‹•ã‘ã¦ã„ã‚‹ã€‚",
        "è³ªã®é«˜ã„ç¡çœ ã‚’ã¨ã‚‹ãŸã‚ã«ã€å¤œã®éã”ã—æ–¹ã‚’å¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã€‚",
        "è‡ªåˆ†ã®èº«ä½“ã‹ã‚‰ã®ã‚µã‚¤ãƒ³ï¼ˆç–²ã‚Œã‚„ç—›ã¿ï¼‰ã«æ°—ã¥ãã€ã™ãã«ã‚±ã‚¢ã§ãã¦ã„ã‚‹ã€‚"
    ],
    "ç¹‹ãŒã‚Š (Connection)": [
        "æœ¬éŸ³ã‚’è©±ã›ã‚‹ä¿¡é ¼ã§ãã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚„å‹äººãŒã„ã‚‹",
        "æ„›ã—æ„›ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†å®Ÿæ„ŸãŒã‚ã‚‹",
        "ç•°ãªã‚‹ä¾¡å€¤è¦³ã‚’æŒã¤äººã¨ã‚‚ã€å»ºè¨­çš„ãªå¯¾è©±ãŒã§ãã‚‹",
        "æœ¬éŸ³ã§èªã‚Šåˆãˆã‚‹å®¶æ—ã€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€ã¾ãŸã¯å‹äººãŒãã°ã«ã„ã‚‹ã€‚",
        "å‘¨å›²ã®äººã«å¯¾ã—ã¦ã€æ„Ÿè¬ã®æ°—æŒã¡ã‚’ç´ ç›´ã«ä¼ãˆã‚‹ã“ã¨ãŒã§ãã¦ã„ã‚‹ã€‚",
        "æå¾—å‹˜å®šæŠœãã§ã€èª°ã‹ã®ãŸã‚ã«è¡Œå‹•ã™ã‚‹ã“ã¨ã«å–œã³ã‚’æ„Ÿã˜ã‚‹ã€‚",
        "å­¤ç‹¬æ„Ÿã‚’æ„Ÿã˜ã‚‹ã“ã¨ã¯å°‘ãªãã€ä¸–ç•Œã‚„ç¤¾ä¼šã¨ç·©ã‚„ã‹ã«ã¤ãªãŒã£ã¦ã„ã‚‹æ„Ÿè¦šãŒã‚ã‚‹ã€‚",
        "è‡ªåˆ†ã¨ã¯é•ã†è€ƒãˆæ–¹ã®äººã‚‚å—ã‘å…¥ã‚Œã€å¯¾è©±ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã‚‹ã€‚",
    ]
}

# è©³ç´°ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ–‡ç«  (Definitions)
definitions = {
    "å“²å­¦ (Philosophy)": {
        "H": ("ã€ç¢ºç«‹ã€‘", "ã‚ãªãŸã¯ç¢ºã‹ãªã€Œè‡ªåˆ†è»¸ã€ã‚’æŒã£ã¦ãŠã‚Šã€é­‚ãŒå–œã¶é¸æŠã‚’é‡ã­ã¦ã“ã‚‰ã‚Œã¾ã—ãŸã€‚ç´ æ™´ã‚‰ã—ã„ã“ã¨ã§ã™ã€‚ä¸€æ–¹ã§ã€ãã®æºã‚‹ãŒãªã„ä¿¡å¿µãŒã€æ™‚ã«å‘¨å›²ã®äººã«ã¨ã£ã¦ã€Œå…¥ã‚Šè¾¼ã¿ã¥ã‚‰ã„å£ã€ã«ãªã£ã¦ã„ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ ã‚ãªãŸã®æ­£ã—ã•ã‚’å°‘ã—ã ã‘ç·©ã‚ãŸã¨ãã€ä¸–ç•Œã¯ã‚‚ã£ã¨å„ªã—ãåºƒãŒã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"),
        "M": ("ã€æ¨¡ç´¢ã€‘", "ä»Šã€æ–°ã—ã„ä¾¡å€¤è¦³ã«è§¦ã‚ŒãªãŒã‚‰ã€Œæœ¬å½“ã®è‡ªåˆ†ã€ã‚’æ¢ã—ã¦ã„ã‚‹æœ€ä¸­ã§ã™ã­ã€‚ãã®è¿·ã„ã¯æˆé•·ã®è¨¼ã§ã™ã€‚ãŸã ã€æ­£è§£ã‚’æ¢ãã†ã¨ã—ã¦æ€è€ƒãŒæ­¢ã¾ã£ã¦ã—ã¾ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ è¿·ã£ãŸã¨ãã¯ã€é ­ã§è€ƒãˆã‚‹ã®ã‚’ã‚„ã‚ã¦ã€ã‚ãªãŸã®ã€Œå¿ƒãŒæ¸©ã‹ããªã‚‹æ–¹ã€ã‚’é¸ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚"),
        "L": ("ã€ä¸åœ¨ã€‘", "å‘¨å›²ã®æœŸå¾…ã«å¿œãˆã‚ˆã†ã¨ã€æŸ”è»Ÿã«åˆã‚ã›ã¦ããŸã‚ãªãŸã®å„ªã—ã•ã‚’æ„Ÿã˜ã¾ã™ã€‚ã§ã‚‚ã€ãã®ãŸã‚ã«è‡ªåˆ†ã®å£°ã‚’å¾Œå›ã—ã«ã—ã™ãã¦ã¯ã„ã¾ã›ã‚“ã‹ï¼Ÿ èª°ã‹ã®äººç”Ÿã‚’ç”Ÿãã‚‹ã®ã§ã¯ãªãã€ã¾ãšã¯1æ—¥5åˆ†ã ã‘ã€ã‚ãªãŸè‡ªèº«ã®ãŸã‚ã«æ™‚é–“ã‚’ä½¿ã£ã¦ã‚ã’ã¦ãã ã•ã„ã€‚")
    },
    "ç’°å¢ƒ (Environment)": {
        "H": ("ã€èª¿å’Œã€‘", "å¿ƒå®‰ã‚‰ãå ´æ‰€ã¨ã€çµŒæ¸ˆçš„ãªå®‰å¿ƒæ„Ÿã€‚ã‚ãªãŸã¯ä»Šã€ã¨ã¦ã‚‚è±Šã‹ãªåœŸå°ã®ä¸Šã«ç«‹ã£ã¦ã„ã¾ã™ã€‚ä»Šã®å¿ƒåœ°ã‚ˆã•ã‚’ååˆ†ã«å‘³ã‚ã„ã¤ã¤ã€ã‚‚ã—å¿ƒã®ã©ã“ã‹ã«ã€Œã¾ã è¡Œã‘ã‚‹ã€ã¨ã„ã†å°ã•ãªç¯ç«ãŒã‚ã‚‹ãªã‚‰ã€å°‘ã—ã ã‘å†’é™ºã®æ—…ã«å‡ºã¦ã¿ã‚‹ã®ã‚‚ç´ æ•µã§ã™ã‚ˆã€‚"),
        "M": ("ã€å‡è¡¡ã€‘", "æ—¥ã€…ã®æš®ã‚‰ã—ã¯å®ˆã‚‰ã‚Œã¦ãŠã‚Šã€ãã®ä¸­ã§ã—ã£ã‹ã‚Šã¨å½¹å‰²ã‚’æœãŸã•ã‚Œã¦ã„ã¾ã™ã­ã€‚ä¸€æ–¹ã§ã€ã€Œã“ã‚Œã§ååˆ†ã ã€ã¨è‡ªåˆ†ã«è¨€ã„èã‹ã›ã¦ã€å°ã•ãªé•å’Œæ„Ÿã«è“‹ã‚’ã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ ã‚ãªãŸã®æ„Ÿæ€§ãŒæ±‚ã‚ã¦ã„ã‚‹ã€Œä½™ç™½ã€ã‚„ã€ŒéŠã³ã€ã‚’ã€ç”Ÿæ´»ã®ä¸­ã«å°‘ã—æ‹›ãå…¥ã‚Œã¦ã¿ã¾ã—ã‚‡ã†ã€‚"),
        "L": ("ã€ç–²å¼Šã€‘", "ä»Šã®ç’°å¢ƒã«é©å¿œã—ã‚ˆã†ã¨ã€äººä¸€å€é ‘å¼µã£ã¦ãã¾ã—ãŸã­ã€‚ãã®å¿è€å¼·ã•ã¯æœ¬å½“ã«ç«‹æ´¾ã§ã™ã€‚ã§ã‚‚ã€ã‚‚ã†ååˆ†ã«æˆ¦ã„ã¾ã—ãŸã€‚ã“ã‚Œä»¥ä¸Šè‡ªåˆ†ã‚’å‰Šã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€Œé€ƒã’ã‚‹ã€ã“ã¨ã¯ã€Œè² ã‘ã€ã§ã¯ãªãã€å¤§åˆ‡ãªã‚ãªãŸè‡ªèº«ã‚’å®ˆã‚‹ãŸã‚ã®ã€Œæ„›ã‚ã‚‹é¸æŠã€ã§ã™ã€‚")
    },
    "æ‰èƒ½ (Talent)": {
        "H": ("ã€é–‹èŠ±ã€‘", "ã‚ãªãŸã®ã‚®ãƒ•ãƒˆï¼ˆæ‰èƒ½ï¼‰ã¯ã€ã™ã§ã«èª°ã‹ã®ç¬‘é¡”ã‚’ç”Ÿã¿å‡ºã—ã¦ã„ã¾ã™ã€‚ã©ã†ã‹è‡ªä¿¡ã‚’æŒã£ã¦ãã ã•ã„ã€‚ãŸã ã€ä»Šã®ã€Œå¾—æ„ã€ã«å®‰ä½ã—ã¦ã—ã¾ã†ã®ã¯ã‚‚ã£ãŸã„ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚ãªãŸã®ä¸­ã«ã¯ã€ã¾ã é–‹ã‘ã‚‰ã‚Œã¦ã„ãªã„æ‰èƒ½ã®ç®±ãŒçœ ã£ã¦ã„ã‚‹ã¯ãšã§ã™ã‹ã‚‰ã€‚"),
        "M": ("ã€åŸçŸ³ã€‘", "ã€Œã“ã‚Œã‹ã‚‚ã—ã‚Œãªã„ã€ã¨ã„ã†æ‰‹å¿œãˆã‚’æ„Ÿã˜å§‹ã‚ã¦ã„ã¾ã™ã­ã€‚ãã®èŠ½ã‚’å¤§åˆ‡ã«ã—ã¾ã—ã‚‡ã†ã€‚ã‚‚ã—ã€Œã‚‚ã£ã¨ã™ã”ããªã‚‰ãªã„ã¨ã€ã¨ç„¦ã£ã¦ã„ã‚‹ãªã‚‰ã€è‚©ã®åŠ›ã‚’æŠœã„ã¦ã€‚èª°ã‹ã«è¤’ã‚ã‚‰ã‚Œã‚‹ãŸã‚ã§ã¯ãªãã€ã‚ãªãŸãŒã€Œã¤ã„å¤¢ä¸­ã«ãªã£ã¦ã—ã¾ã†æ™‚é–“ã€ã‚’å¢—ã‚„ã™ã ã‘ã§ååˆ†ã§ã™ã€‚"),
        "L": ("ã€å°å°ã€‘", "æ…é‡ã§è¬™è™šãªã‚ãªãŸã¯ã€ã¾ã è‡ªåˆ†ã®è¼ãã‚’éå°è©•ä¾¡ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã€Œç§ã«ã¯ä½•ã‚‚ãªã„ã€ã¨æ€ã£ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ å®Ÿã¯ã€ã‚ãªãŸãŒã€Œå½“ãŸã‚Šå‰ã«ã§ãã¦ã„ã‚‹ã“ã¨ã€ã®ä¸­ã«ã“ãã€æœ€å¼·ã®æ­¦å™¨ãŒéš ã•ã‚Œã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã®è‰¯ã•ã‚’ã€ã‚‚ã£ã¨è¨±ã—ã¦ã‚ã’ã¦ãã ã•ã„ã€‚")
    },
    "æ§‹æƒ³ (Vision)": {
        "H": ("ã€é®®æ˜ã€‘", "ç†æƒ³ã®æœªæ¥ãŒã‚¯ãƒªã‚¢ã«è¦‹ãˆã¦ã„ã¾ã™ã­ã€‚äººç”Ÿã®è„šæœ¬å®¶ã¯ã‚ãªãŸè‡ªèº«ã§ã™ã€‚ãã®ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹æ™¯è‰²ã‚’å¤§åˆ‡ã«ã—ã¦ãã ã•ã„ã€‚ã‚‚ã—è¶³å…ƒãŒå°‘ã—ãŠã‚ãã‹ã«ãªã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ãŸã‚‰ã€é ãã‚’è¦‹ã¤ã‚ã‚‹æ™‚é–“ã‚’å°‘ã—æ¸›ã‚‰ã—ã€ä»Šæ—¥ã®ä¸€æ­©ã‚’æ„›ã§ã‚‹æ™‚é–“ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚"),
        "M": ("ã€å±•æœ›ã€‘", "ã€Œã“ã†ãªã£ãŸã‚‰ã„ã„ãªã€ã¨ã„ã†äºˆæ„Ÿã«èƒ¸ã‚’è†¨ã‚‰ã¾ã›ã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã­ã€‚ãã®å¸Œæœ›ã¯ã¨ã¦ã‚‚å¤§åˆ‡ã§ã™ã€‚ãã®å¤¢ã‚’ã€Œã„ã¤ã‹ã€ã®ã¾ã¾ã«ã›ãšã€å°‘ã—ã ã‘è§£åƒåº¦ã‚’ä¸Šã’ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ å…·ä½“çš„ãªã€ŒåŒ‚ã„ã€ã‚„ã€ŒéŸ³ã€ã¾ã§æƒ³åƒã§ããŸã¨ãã€ç¾å®Ÿã¯å‹•ãå‡ºã—ã¾ã™ã€‚"),
        "L": ("ã€æ¼‚æµã€‘", "ç›®ã®å‰ã®ã“ã¨ã«èª å®Ÿã«å‘ãåˆã„ã€ä»Šæ—¥ã‚’æ‡¸å‘½ã«ç”Ÿãã¦ã„ã¾ã™ã€‚ãã®å®Ÿç›´ã•ã¯ã‚ãªãŸã®å¼·ã¿ã§ã™ã€‚ãŸã ã€ã‚‚ã—ã€Œã©ã“ã¸å‘ã‹ã£ã¦ã„ã‚‹ã‚“ã ã‚ã†ã€ã¨ã„ã†ä¸å®‰ãŒã‚ã‚‹ãªã‚‰ã€ä¸€åº¦ç«‹ã¡æ­¢ã¾ã£ã¦æ˜Ÿã‚’è¦‹ä¸Šã’ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ç¾åœ¨åœ°ã‚’çŸ¥ã‚‹ã“ã¨ã¯ã€æ±ºã—ã¦æ™‚é–“ã®ç„¡é§„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã‚ˆã€‚")
    },
    "å¥åº· (Vitality)": {
        "H": ("ã€å……å®Ÿã€‘", "ç”Ÿå‘½åŠ›ãŒæº¢ã‚Œã€ç›´æ„Ÿã‚‚å†´ãˆæ¸¡ã£ã¦ã„ã¾ã™ã­ï¼ ãã®é«˜ã„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€ã‚ãªãŸã®äººç”Ÿã‚’åˆ‡ã‚Šæ‹“ãæœ€é«˜ã®ã‚®ãƒ•ãƒˆã§ã™ã€‚ã“ã®ä¸‡èƒ½æ„Ÿã‚’æ¥½ã—ã‚“ã§ãã ã•ã„ã€‚ãã—ã¦ã€èµ°ã‚Šç¶šã‘ã‚‹ãŸã‚ã«ã“ãã€æ™‚ã«ã¯ã‚ãˆã¦ãƒšãƒ¼ã‚¹ã‚’è½ã¨ã—ã€ç¾½ã‚’ä¼‘ã‚ã‚‹æ™‚é–“ã‚‚è‡ªåˆ†ã«ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã—ã¦ã‚ã’ã¾ã—ã‚‡ã†ã€‚"),
        "M": ("ã€ç¶­æŒã€‘", "è‡ªåˆ†ã®ãƒªã‚ºãƒ ã‚’ä¿ã¡ã€å¤§ããªæ³¢é¢¨ãªãéã”ã›ã¦ã„ã¾ã™ã€‚ã‚»ãƒ«ãƒ•ã‚±ã‚¢ãŒã§ãã¦ã„ã‚‹è¨¼æ‹ ã§ã™ã€‚ãŸã ã€ã€Œãªã‚“ã¨ãªããƒ€ãƒ«ã„ã€ã¨ã„ã†èº«ä½“ã®å£°ã‚’ã€Œã„ã¤ã‚‚ã®ã“ã¨ã€ã¨æµã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ ãã®å°ã•ãªã‚µã‚¤ãƒ³ã‚’ä¸å¯§ã«æ‹¾ã†ã“ã¨ã§ã€ã‚ãªãŸã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯ã‚‚ã£ã¨å®‰å®šã—ã¾ã™ã€‚"),
        "L": ("ã€æ¯æ¸‡ã€‘", "æ°—åŠ›ã ã‘ã§è²¬ä»»ã‚’æœãŸã—ã¦ããŸã€ã‚ãªãŸã®è²¬ä»»æ„Ÿã®å¼·ã•ã«ã¯é ­ãŒä¸‹ãŒã‚Šã¾ã™ã€‚ã§ã‚‚ã€èº«ä½“ã¯æ­£ç›´ã§ã™ã€‚ä»Šã¯ã€Œé ‘å¼µã‚‹ã€ã“ã¨ã‚ˆã‚Šã‚‚ã€Œä¼‘ã‚€ã€ã“ã¨ãŒã€ã‚ãªãŸã«ã¨ã£ã¦ä¸€ç•ªå¤§åˆ‡ãªä»•äº‹ã§ã™ã€‚æ³¥ã®ã‚ˆã†ã«çœ ã‚‹ã“ã¨ã‚’ã€ã©ã†ã‹è‡ªåˆ†ã«è¨±ã—ã¦ã‚ã’ã¦ãã ã•ã„ã€‚")
    },
    "ç¹‹ãŒã‚Š (Connection)": {
        "H": ("ã€æ„›ã€‘", "ã‚ãªãŸã¯æ„›ã—æ„›ã•ã‚Œã‚‹å–œã³ã«åŒ…ã¾ã‚Œã€æ¸©ã‹ã„å®‰å¿ƒæ„Ÿã®ä¸­ã«ã„ã¾ã™ã€‚ãã‚Œã¯ä½•ã«ã‚‚ä»£ãˆãŒãŸã„å®ç‰©ã§ã™ã€‚ãã®å®‰å…¨åŸºåœ°ãŒã‚ã‚‹ã‚ãªãŸãªã‚‰ã€ã‚‚ã†å°‘ã—å¤–ã®ä¸–ç•Œã¸å†’é™ºã«å‡ºã¦ã‚‚å¤§ä¸ˆå¤«ã€‚ç•°ãªã‚‹ä¾¡å€¤è¦³ã‚’æŒã¤äººã€…ã¨ã®å‡ºä¼šã„ãŒã€ã‚ãªãŸã®æ„›ã‚’ã•ã‚‰ã«æ·±ãã™ã‚‹ã§ã—ã‚‡ã†ã€‚"),
        "M": ("ã€å”èª¿ã€‘", "èª°ã¨ã§ã‚‚å††æ»‘ã«é–¢ã‚ã‚Œã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èƒ½åŠ›ã‚’ãŠæŒã¡ã§ã™ã­ã€‚ç´ æ•µã§ã™ã€‚ä¸€æ–¹ã§ã€å¿ƒã®å¥¥åº•ã«ã‚ã‚‹ã€Œå¼±ã•ã€ã‚’è¦‹ã›ã‚‹ã“ã¨ã«ã€å°‘ã—æ€–ã•ã‚’æ„Ÿã˜ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ å®Œç’§ã§ãªã„ã‚ãªãŸã‚’è¦‹ã›ãŸã¨ãã“ãã€æœ¬å½“ã®æ·±ã„çµ†ãŒçµã°ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"),
        "L": ("ã€å­¤ç‹¬ã€‘", "èª°ã«ã‚‚ä¾å­˜ã›ãšã€ç‹¬ã‚Šã§ç«‹ã¡ç¶šã‘ã‚‹å¼·ã•ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãã®è‡ªç«‹å¿ƒã¯èª‡ã‚‹ã¹ãã‚‚ã®ã§ã™ã€‚ã§ã‚‚ã€ã‚‚ã—å¿ƒãŒå¼µã‚Šè©°ã‚ã¦ã„ã‚‹ãªã‚‰ã€ã»ã‚“ã®å°‘ã—ã ã‘è·ç‰©ã‚’é™ã‚ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ ä¸–ç•Œã¯ã‚ãªãŸãŒæ€ã£ã¦ã„ã‚‹ã‚ˆã‚Šã‚‚ã€ãšã£ã¨å„ªã—ãã¦æ¸©ã‹ã„å ´æ‰€ã§ã™ã‚ˆã€‚")
    }
}

# --- 2. åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ (Archetype Logic) ---
def calculate_archetype(scores):
    phi = scores.get("å“²å­¦ (Philosophy)", 0)
    env = scores.get("ç’°å¢ƒ (Environment)", 0)
    tal = scores.get("æ‰èƒ½ (Talent)", 0)
    des = scores.get("æ§‹æƒ³ (Vision)", 0)
    vit = scores.get("å¥åº· (Vitality)", 0)
    con = scores.get("ç¹‹ãŒã‚Š (Connection)", 0)
    
    min_score = min(scores.values())
    max_score = max(scores.values())

    # 1. Type 5 (çµ±åˆã•ã‚ŒãŸçµ±æ²»è€…) - å…¨ã¦4.0ä»¥ä¸Š
    if min_score >= 4.0:
        return "Type 5: çµ±åˆã•ã‚ŒãŸçµ±æ²»è€…", "äººç”Ÿã®ã‚ã‚‰ã‚†ã‚‹è¦ç´ ãŒèª¿å’Œã—ã€ã‚ãªãŸã¯è‡ªåˆ†ã®ç‹å›½ã‚’ã—ã£ã‹ã‚Šã¨æ²»ã‚ã¦ã„ã¾ã™ã€‚å®Œç’§ã«è¦‹ãˆã‚‹ä»Šã ã‹ã‚‰ã“ãã€ã‚ãˆã¦ã€Œéš™ã€ã‚„ã€ŒéŠã³ã€ã‚’ä½œã‚‹ã“ã¨ã§ã€é­…åŠ›ã¯ã•ã‚‰ã«æ·±ã¾ã‚‹ã§ã—ã‚‡ã†ã€‚", "ğŸ‘‘"

    # 2. Type 1 (å‚·ã¤ã„ãŸæˆ¦å£«) - å¥åº·<3.0 or å…¨ä½“<2.5
    if vit < 3.0 or max_score < 2.5:
        return "Type 1: å‚·ã¤ã„ãŸæˆ¦å£«", "è²¬ä»»æ„Ÿã¨å„ªã—ã•ã‚†ãˆã«ã€ã‚ãªãŸã¯èª°ã‚ˆã‚Šã‚‚æˆ¦ã„ç¶šã‘ã¦ãã¾ã—ãŸã€‚ã§ã‚‚ã€ã‚‚ã†ååˆ†ã§ã™ã€‚ä»Šã¯ãã®é‡ã„é§ã‚’è„±ã„ã§ã€æˆ¦å ´ã‹ã‚‰é›¢ã‚Œã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ å‚·ã‚’ç™’ã‚„ã™ã“ã¨ã¯ã€å¼±ã•ã§ã¯ãªãã€æ¬¡ã«é€²ã‚€ãŸã‚ã®å‹‡æ°—ã‚ã‚‹é¸æŠã§ã™ã€‚", "ğŸ›¡ï¸"

    # 3. è¤‡åˆã‚¿ã‚¤ãƒ—
    if con >= 4.0 and des >= 4.0 and vit >= 3.5:
        return "Type 9: æ±‚å¿ƒåŠ›ã‚ã‚‹ãƒªãƒ¼ãƒ€ãƒ¼", "ã‚ãªãŸã®å‘¨ã‚Šã«ã¯è‡ªç„¶ã¨äººãŒé›†ã¾ã‚Šã€å¤§ããªæ¸¦ãŒç”Ÿã¾ã‚Œã¾ã™ã€‚çš†ã®æƒ³ã„ã‚’èƒŒè² ã£ã¦é€²ã‚€ã“ã¨ãŒã§ãã‚‹ãƒªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚æœŸå¾…ã«å¿œãˆã‚‹ã“ã¨ã‚‚å¤§åˆ‡ã§ã™ãŒã€ã‚ãªãŸè‡ªèº«ã®é­‚ã®ç´”åº¦ã‚’ä¿ã¤ã“ã¨ãŒã€çµæœã¨ã—ã¦çš†ã‚’å¹¸ã›ã«ã—ã¾ã™ã€‚", "ğŸŒ"
    if tal >= 4.0 and des >= 4.0:
        return "Type 13: æ§‹æƒ³ã™ã‚‹å»ºç¯‰å®¶", "ã‚ãªãŸã®é ­ã®ä¸­ã«ã¯ã€ç¾ã—ã„æœªæ¥ã®è¨­è¨ˆå›³ãŒå®Œæˆã—ã¦ã„ã¾ã™ã€‚ãã®æ‰èƒ½ã¨ãƒ“ã‚¸ãƒ§ãƒ³ã¯ä¸–ç•Œã‚’å¤‰ãˆã‚‹åŠ›ãŒã‚ã‚Šã¾ã™ã€‚ã‚ã¨ã¯ã€ãã‚Œã‚’ç¾å®Ÿã«é™ã‚ã™ãŸã‚ã®ã€ŒåœŸå°ï¼ˆç’°å¢ƒï¼‰ã€ä½œã‚ŠãŒéµã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚", "ğŸ—ï¸"
    if tal >= 4.0 and con >= 4.0:
        return "Type 10: è¼ã‘ã‚‹è¡¨ç¾è€…", "ã‚ãªãŸã«ã¯äººã€…ã‚’é­…äº†ã™ã‚‹è¯ãŒã‚ã‚Šã¾ã™ã€‚æ‰èƒ½ã¨æ„›å¬Œã‚’å…¼ã­å‚™ãˆãŸã‚ãªãŸã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¸ã«ç«‹ã¤ã¹ãã—ã¦ç”Ÿã¾ã‚ŒãŸäººã€‚ä»–è€…ã®è©•ä¾¡ã‚ˆã‚Šã‚‚ã€ã‚ãªãŸè‡ªèº«ãŒã€Œæ¥½ã—ã‚€ã€ã“ã¨ã‚’æœ€å„ªå…ˆã«ã—ã¦ãã ã•ã„ã€‚", "ğŸŒŸ"
    if phi >= 4.0 and des >= 4.0:
        return "Type 7: æˆ¦ç•¥çš„ãªç­–å£«", "ç¢ºå›ºãŸã‚‹ä¿¡å¿µã¨ã€æœªæ¥ã‚’è¦‹é€šã™ç›®ã‚’æŒã£ã¦ã„ã¾ã™ã€‚æ„Ÿæƒ…ã«æµã•ã‚Œãšã€æœ€çŸ­è·é›¢ã§ã‚´ãƒ¼ãƒ«ã‚’ç›®æŒ‡ã™çŸ¥æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®å†·å¾¹ãªã¾ã§ã®è³¢ã•ã«ã€Œæ„›æ•¬ã€ãŒåŠ ã‚ã‚Œã°ã€ã‚ãªãŸã¯ç„¡æ•µã§ã™ã€‚", "â™Ÿï¸"

    # 4. å˜ç‹¬ã‚¿ã‚¤ãƒ—
    if phi >= 4.0:
        return "Type 4: å“²å­¦ã™ã‚‹è³¢è€…", "ã‚ãªãŸã¯æºã‚‹ãŒãªã„ã€Œè‡ªåˆ†è»¸ã€ã¨æ·±ã„çŸ¥æµã‚’æŒã£ã¦ã„ã¾ã™ã€‚å‘¨å›²ã®é›‘éŸ³ã«æƒ‘ã‚ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®é«˜æ½”ãªç²¾ç¥æ€§ã‚’ã€ä»Šåº¦ã¯ã€Œä»–è€…ã€ã¨åˆ†ã‹ã¡åˆã†ã“ã¨ã§ã€ã‚ãªãŸã®ä¸–ç•Œã¯ã•ã‚‰ã«åºƒãŒã‚Šã¾ã™ã€‚", "ğŸ¦‰"
    if env >= 4.0:
        return "Type 2: å®ˆã‚Šè‚²ã¦ã‚‹å®ˆè­·è€…", "ã‚ãªãŸã«ã¯å®‰å¿ƒã§ãã‚‹è±Šã‹ãªåœŸå°ãŒã‚ã‚Šã¾ã™ã€‚å‘¨å›²ã®äººã‚’å®ˆã‚Šã€è‚²ã¦ã‚‹åŒ…å®¹åŠ›ã«æº¢ã‚Œã¦ã„ã¾ã™ã€‚ä¸ãˆã‚‹ã°ã‹ã‚Šã§ã¯ãªãã€æ™‚ã«ã¯ã‚ãªãŸè‡ªèº«ãŒã€Œå®ˆã‚‰ã‚Œã‚‹ã€å–œã³ã‚‚å‘³ã‚ã£ã¦ãã ã•ã„ã€‚", "ğŸŒ³"
    if tal >= 4.0:
        return "Type 8: å­¤é«˜ã®è·äºº", "å“è¶Šã—ãŸã‚¹ã‚­ãƒ«ã¨æ‰èƒ½ã‚’æŒã£ã¦ã„ã¾ã™ã€‚èª°ã«ã‚‚çœŸä¼¼ã§ããªã„ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚’ç”Ÿã¿å‡ºã™åŠ›ã¯ã€ä¸€ç¨®ã®é­”æ³•ã§ã™ã€‚ãã®æ‰èƒ½ã‚’è‡ªåˆ†ã ã‘ã®ã‚‚ã®ã«ã›ãšã€ä¸–ç•Œã¸ã®ã‚®ãƒ•ãƒˆã¨ã—ã¦é–‹æ”¾ã™ã‚‹æ™‚ãŒæ¥ã¦ã„ã¾ã™ã€‚", "ğŸ”¨"
    if des >= 4.0:
        return "Type 12: å¤¢è¦‹ã‚‹æ—…äºº", "èª°ã‚ˆã‚Šã‚‚é ãã®æœªæ¥ã‚’è¦‹ã¦ã„ã¾ã™ã€‚ã‚ãªãŸã®èªã‚‹å¤¢ã¯ã€äººã€…ã«å¸Œæœ›ã‚’ä¸ãˆã¾ã™ã€‚ã‚ã¨ã¯ã€Œæœ€åˆã®ä¸€æ­©ã€ã‚’è¸ã¿å‡ºã™ã ã‘ã€‚å¤¢ã‚’ç¾å®Ÿã«ã™ã‚‹ãŸã‚ã®æ³¥è‡­ã„è¡Œå‹•ãŒã€ã‚ãªãŸã‚’çœŸã®å‹‡è€…ã«ã—ã¾ã™ã€‚", "ğŸŒˆ"
    if vit >= 4.0:
        return "Type 6: æ´»æ°—ã‚ã‚‹å†’é™ºå®¶", "ç”Ÿå‘½åŠ›ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«æº€ã¡æº¢ã‚Œã¦ã„ã¾ã™ã€‚ã‚ãªãŸã®å­˜åœ¨ãã®ã‚‚ã®ãŒã€å‘¨å›²ã‚’æ˜ã‚‹ãç…§ã‚‰ã™ãƒ‘ãƒ¯ãƒ¼ã§ã™ã€‚ãã®æœ‰ã‚Šä½™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ã€èª°ã‹ã®ãŸã‚ã«ä½¿ã£ãŸæ™‚ã€ä¼èª¬ãŒå§‹ã¾ã‚Šã¾ã™ã€‚", "ğŸ”¥"
    if con >= 4.0:
        return "Type 11: æ„›ã®äºº", "ã‚ãªãŸã®äººç”Ÿã¯æ„›ã¨å–œã³ã«æº€ã¡ã¦ã„ã¾ã™ã€‚äººã¨ã®ç¹‹ãŒã‚Šã“ããŒã‚ãªãŸã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æºã§ã™ã€‚ãã®æ¸©ã‹ã•ã§å‘¨å›²ã‚’ç™’ã‚„ã—ã¤ã¤ã€æ™‚ã«ã¯è‡ªåˆ†è‡ªèº«ã®å†…ãªã‚‹å£°ï¼ˆå“²å­¦ï¼‰ã«ã‚‚è€³ã‚’å‚¾ã‘ã¦ã¿ã¦ãã ã•ã„ã€‚", "ğŸ’"

    # 5. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
    return "Type 3: èª¿å’Œã™ã‚‹å¸‚æ°‘", "ã‚ãªãŸã¯ãƒãƒ©ãƒ³ã‚¹æ„Ÿè¦šã«å„ªã‚Œã€ã©ã®ã‚ˆã†ãªç’°å¢ƒã§ã‚‚é©å¿œã§ãã‚‹æŸ”è»Ÿæ€§ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ä»Šã¯ã¾ã ã€Œã“ã‚Œã ï¼ã€ã¨ã„ã†æ­¦å™¨ãŒè¦‹ã¤ã‹ã£ã¦ã„ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ãã‚Œã¯ä½•ã«ã§ã‚‚ãªã‚Œã‚‹å¯èƒ½æ€§ã®è¨¼ã§ã™ã€‚ã¾ãšã¯ä¸€ç•ªä½ã„ã‚¹ã‚³ã‚¢ã®è¦ç´ ã‚’ç£¨ã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚", "ğŸŒ±"

# --- 3. UIæ§‹ç¯‰ ---

st.markdown('<div class="main-header">Life Mapping Diagnosis</div>', unsafe_allow_html=True)
st.markdown('<div class="sub-header">äººç”Ÿã®ç¾åœ¨åœ°ã‚’æ¸¬ã‚‹ 36ã®å•ã„</div>', unsafe_allow_html=True)

# â˜…è¿½åŠ : å°å…¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å®‰å¿ƒæ„Ÿã‚’ä¸ãˆã€è¨ºæ–­ã¸ã®æ²¡å…¥æ„Ÿã‚’é«˜ã‚ã¾ã™
st.markdown("""
<div style="background-color: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 30px; border-left: 5px solid #1E3A8A; color: #475569;">
    <p style="margin:0; line-height: 1.8;">
        ã‚ˆã†ã“ãã€Life Mappingã¸ï¼<br>
        ã“ã®è¨ºæ–­ã¯ã€ã‚ãªãŸã®äººç”Ÿã‚’æ§‹æˆã™ã‚‹<b>6ã¤ã®è¦ç´ ï¼ˆå“²å­¦ãƒ»ç’°å¢ƒãƒ»æ‰èƒ½ãƒ»æ§‹æƒ³ãƒ»å¥åº·ãƒ»ç¹‹ãŒã‚Šï¼‰</b>ã®çŠ¶æ…‹ã‚’å¯è¦–åŒ–ã—ã€
        ä»Šã‚ãªãŸãŒã©ã®ã‚ˆã†ãª<b>ã€Œã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—ï¼ˆå†’é™ºè€…ã¨ã—ã¦ã®ã‚¿ã‚¤ãƒ—ï¼‰ã€</b>ã‚’ç”Ÿãã¦ã„ã‚‹ã®ã‹ã‚’ç´è§£ãã¾ã™ã€‚<br><br>
        <b>æ‰€è¦æ™‚é–“ã¯ç´„2ï½3åˆ†ã§ã™ã€‚</b><br>
        ã‚ã¾ã‚Šæ·±ãè€ƒãˆã™ããšã€ä»Šã®æ„Ÿè¦šã«ä¸€ç•ªè¿‘ã„ã‚‚ã®ã‚’ç›´æ„Ÿçš„ã«é¸ã‚“ã§ãã ã•ã„ã€‚<br>
        ã‚ãªãŸã®ç¾åœ¨åœ°ã‚’çŸ¥ã‚‹ã“ã¨ãŒã€ç†æƒ³ã®æœªæ¥ã¸é€²ã‚€ãŸã‚ã®æœ€åˆã®ä¸€æ­©ã«ãªã‚Šã¾ã™ã€‚
    </p>
</div>
""", unsafe_allow_html=True)

# ãƒ•ã‚©ãƒ¼ãƒ ãªã—ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ ã®ãŸã‚ï¼‰
name = st.text_input("ãŠåå‰ (Name)", placeholder="ä¾‹: å±±ç”° å¤ªéƒ")
st.markdown("---")
user_scores = {}

# é¸æŠè‚¢ã®å®šç¾©
options = {
    1: "å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„", 
    2: "ã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„", 
    3: "ã©ã¡ã‚‰ã¨ã‚‚è¨€ãˆãªã„", 
    4: "ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹", 
    5: "éå¸¸ã«å½“ã¦ã¯ã¾ã‚‹"
}

# ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ãƒ«ãƒ¼ãƒ—
for category, q_list in questions_data.items():
    st.markdown(f'<div class="category-header">{category}</div>', unsafe_allow_html=True)
    
    cat_answers = []
    for i, q_text in enumerate(q_list):
        # 1. è³ªå•æ–‡
        st.markdown(f"**Q.{i+1} {q_text}**")
        
        # ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ã‚­ãƒ¼ã‚’å®šç¾©
        slider_key = f"{category}_{i}"
        
        # ç¾åœ¨ã®å€¤ã‚’å–å¾—ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆã«ã‚ã‚Œã°ãã‚Œã‚’ã€ãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ3ï¼‰
        if slider_key in st.session_state:
            current_val = st.session_state[slider_key]
        else:
            current_val = 3
        
        # 2. å…¨é¸æŠè‚¢ã‚’ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ä¸Šã«è¡¨ç¤º (é¸æŠä¸­ã®ã¿ãƒã‚¤ãƒ©ã‚¤ãƒˆ)
        legend_html = ""
        for k, v in options.items():
            if k == current_val:
                # é¸æŠä¸­ã®ã‚¹ã‚¿ã‚¤ãƒ«
                if k <= 2: color = "#ef4444"   # èµ¤
                elif k == 3: color = "#f97316" # ã‚ªãƒ¬ãƒ³ã‚¸
                else: color = "#3b82f6"        # é’
                
                legend_html += f"<span style='color: {color}; font-weight: bold; font-size: 1.1rem; margin: 0 8px; display: inline-block;'>{k}. {v}</span>"
            else:
                # éé¸æŠã®ã‚¹ã‚¿ã‚¤ãƒ«
                legend_html += f"<span style='color: #cbd5e1; font-size: 0.8rem; margin: 0 5px; display: inline-block;'>{k}. {v}</span>"

        st.markdown(f"""
        <div style="text-align: center; line-height: 1.8; margin-bottom: 5px;">
            {legend_html}
        </div>
        """, unsafe_allow_html=True)
        
        # 3. ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ (ãƒ©ãƒ™ãƒ«ãªã—)
        val = st.select_slider(
            label="å›ç­”", 
            options=[1, 2, 3, 4, 5],
            value=3, 
            key=slider_key,
            label_visibility="collapsed"
        )
        
        cat_answers.append(val)
    
    user_scores[category] = statistics.mean(cat_answers)

st.markdown("---")

if st.button("è¨ºæ–­çµæœã‚’è¡¨ç¤ºã™ã‚‹"):
    if not name:
        st.error("ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
    else:
        archetype_name, description, icon = calculate_archetype(user_scores)
        st.balloons()
        
        st.success(f"è¨ºæ–­å®Œäº†ï¼ {name} ã•ã‚“ã®ç¾åœ¨åœ°ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚")
        col1, col2 = st.columns([1, 1.2])
        
        with col1:
            # ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
            categories = list(user_scores.keys())
            values = list(user_scores.values())
            fig = go.Figure()
            fig.add_trace(go.Scatterpolar(
                r=values, theta=categories, fill='toself', name=name,
                line_color='#1E3A8A', fillcolor='rgba(30, 58, 138, 0.2)'
            ))
            fig.update_layout(polar=dict(radialaxis=dict(visible=True, range=[0, 5])), showlegend=False, margin=dict(l=40, r=40, t=30, b=30))
            st.plotly_chart(fig, use_container_width=True)

        with col2:
            st.markdown(f"### {icon} {archetype_name}")
            st.info(description)
            
            st.markdown("#### Life Elements Analysis")
            
            # å„è¦ç´ ã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
            for cat, score in user_scores.items():
                # H/M/L åˆ¤å®š
                if score >= 4.0:
                    level, level_color = "H", "tag-blue"
                    bar_color = "blue"
                elif score >= 2.5:
                    level, level_color = "M", "tag-green"
                    bar_color = "green"
                else:
                    level, level_color = "L", "tag-red"
                    bar_color = "red"
                
                # æ–‡ç« ã®å–å¾—
                tag_text, feedback_text = definitions[cat][level]
                
                # ã‚¹ã‚³ã‚¢ãƒãƒ¼è¡¨ç¤º
                bar_bg = f"background-color: {'#dbeafe' if bar_color=='blue' else '#dcfce7' if bar_color=='green' else '#fee2e2'};"
                st.markdown(f"""
                    <div style="margin-top: 10px; margin-bottom: 2px;">
                        <span style="font-weight:bold;">{cat}: {score:.1f}</span> 
                        <span class="{level_color}">{tag_text}</span>
                    </div>
                    <div style="width: 100%; background-color: #f3f4f6; border-radius: 5px; height: 8px;">
                        <div style="width: {score/5*100}%; {bar_bg} height: 8px; border-radius: 5px;"></div>
                    </div>
                    """, unsafe_allow_html=True)
                
                # ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ–‡ç« 
                with st.expander(f"â–¼ {cat}ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’èª­ã‚€"):
                    st.markdown(f'<div class="feedback-box">{feedback_text}</div>', unsafe_allow_html=True)

        # Noteã¸ã®èª˜å°
        st.markdown("---")
        st.markdown("### ğŸ Next Step")
        st.markdown(f"""
        **{archetype_name}** ã®ã‚ãªãŸã¸ã€‚
        
        ã“ã®è¨ºæ–­çµæœã¯ã‚ãã¾ã§ã€Œç¾åœ¨åœ°ã€ã§ã™ã€‚
        ã“ã®è¨ºæ–­çµæœã‚’ã‚‚ã¨ã«ã€ã‚ˆã‚Šè©³ç´°ãªåœ°å›³ã‚’æã„ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ
        
        **ğŸ‘‰ [Life Mapping Coaching (note)](https://note.com/toyamanchu1986/n/nd31342d61419)**
        """)